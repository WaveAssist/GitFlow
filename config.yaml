name: GitFlow
description: The Ground Truth Report for CEOs, CTOs, and Product leaders—project-centric and multi-repo. AI reads the actual code diffs across your entire stack (frontend, backend, infra) and converts what really shipped into one unified, leadership-ready business + technical narrative (single email + PDF).
success_message: GitFlow is set up and running. Each week you'll get a single combined, leadership-ready Ground Truth report—business + technical—AI-generated from the actual code diffs in the past 7 days.
output_default_message: "Run completed. The Ground Truth report was generated by AI and sent (email + PDF)."

requirements: []

nodes:
  - key: check_credits_and_init
    name: CheckCreditsAndInit
    file_name: check_credits_and_init.py
    starting_node: true
    schedule:
      cron: "30 8 * * 1" # Every: Monday at 8:30 AM UTC
      timezone: "UTC"

  - key: fetch_repository_context
    name: FetchRepositoryContext
    file_name: fetch_repository_context.py
    run_after:
      - check_credits_and_init

  - key: fetch_github_activity
    name: FetchGitHubActivity
    file_name: fetch_github_activity.py
    run_after:
      - fetch_repository_context

  - key: analyze_repository_activity
    name: AnalyzeRepositoryActivity
    file_name: analyze_repository_activity.py
    run_after:
      - fetch_github_activity

  - key: generate_business_report
    name: GenerateBusinessReport
    file_name: generate_business_report.py
    run_after:
      - analyze_repository_activity

  - key: generate_technical_report
    name: GenerateTechnicalReport
    file_name: generate_technical_report.py
    run_after:
      - generate_business_report

  - key: send_emails
    name: SendEmails
    file_name: send_emails.py
    run_after:
      - generate_technical_report

variables:
  - type: github
    name: github
    display_name: GitHub
    key: github
    is_optional: false
    scopes: ["repo"]
    required_resources: ["repos"]
    helper_message: "Connect your GitHub account to track repositories"

  - name: project_name
    key: project_name
    display_name: Project Name
    value: ""
    type: "string"
    is_optional: false
    helper_message: "Name of your project or team (e.g., Acme Backend, Mobile App)"

  - name: model_name
    key: model_name
    display_name: Model name
    value: "anthropic/claude-haiku-4.5"
    type: "string"
    is_optional: true
    helper_message: "Select model for analysis and report generation"
    options:
      - name: Claude Haiku 4.5
        key: anthropic/claude-haiku-4.5
      - name: Claude Sonnet 4.5
        key: anthropic/claude-sonnet-4.5
      - name: Grok Code Fast 1
        key: x-ai/grok-code-fast-1
      - name: Claude Sonnet 4
        key: anthropic/claude-sonnet-4
      - name: Gemini 2.5 Flash
        key: google/gemini-2.5-flash
      - name: DeepSeek Chat V3.1
        key: deepseek/deepseek-chat-v3.1
      - name: GPT-5 Mini
        key: openai/gpt-5-mini

  - name: schedule
    key: schedule
    display_name: Schedule
    value:
      cron: "30 8 * * 1"
    type: "schedule"
    is_optional: true
    helper_message: "Select schedule for weekly reports, default is every Monday at 8:30 AM UTC"
